<!DOCTYPE html>
<html lang="zh-TW">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>é«”è„‚åˆ†æå„€| Body Composition Pro</title>
<link rel="icon" href="https://cdnjs.cloudflare.com/ajax/libs/twemoji/14.0.2/72x72/1f6a9.png">
<link href="https://fonts.googleapis.com/css2?family=Noto+Serif+TC:wght@300;400;500&family=DM+Serif+Display:ital@0;1&family=Noto+Sans+TC:wght@300;400&display=swap" rel="stylesheet">
<style>
  :root {
    --morandi-green: #7d9b8a;
    --morandi-light: #a8c0b0;
    --morandi-pale: #ccddd5;
    --morandi-mist: #e8f0ec;
    --morandi-deep: #5a7566;
    --morandi-dark: #3d5248;
    --morandi-sage: #b5c9bf;
    --bg: #f2f5f3;
    --text-main: #2e3d36;
    --text-sub: #6b8277;
    --text-light: #9ab5a8;
    --card-bg: #ffffff;
    --border: #d4e3dc;
  }

    /* äººé«”ç¤ºæ„åœ–å®¹å™¨ */
  .diagram-card {
    display: flex;
    justify-content: center;
    align-items: center;
    background: var(--card-bg);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 20px;
    margin-bottom: 20px;
    min-height: 300px;
  }

  .human-svg {
    height: 280px;
    width: auto;
  }

  /* æ¸¬é‡é»æ¨£å¼ */
  .measure-point {
    fill: var(--morandi-pale);
    stroke: white;
    stroke-width: 1;
    transition: all 0.3s ease;
    opacity: 0.3;
  }

  /* é«˜äº®ç‹€æ…‹ */
  .measure-point.active {
    fill: var(--morandi-green);
    opacity: 1;
    r: 6; /* åœ“é»è®Šå¤§ */
    filter: drop-shadow(0 0 4px rgba(125,155,138,0.5));
  }

  .body-outline {
    fill: var(--morandi-mist);
    stroke: var(--morandi-sage);
    stroke-width: 1;
  }

  * { margin: 0; padding: 0; box-sizing: border-box; }

  body {
    font-family: 'Noto Sans TC', sans-serif;
    background: var(--bg);
    color: var(--text-main);
    min-height: 100vh;
    position: relative;
    overflow-x: hidden;
  }

  body::before {
    content: '';
    position: fixed;
    top: -200px; right: -200px;
    width: 600px; height: 600px;
    background: radial-gradient(circle, rgba(168,192,176,0.18) 0%, transparent 70%);
    pointer-events: none;
    z-index: 0;
  }

  body::after {
    content: '';
    position: fixed;
    bottom: -150px; left: -150px;
    width: 500px; height: 500px;
    background: radial-gradient(circle, rgba(125,155,138,0.12) 0%, transparent 70%);
    pointer-events: none;
    z-index: 0;
  }

  .container {
    max-width: 820px;
    margin: 0 auto;
    padding: 48px 24px 80px;
    position: relative;
    z-index: 1;
  }

  header {
    text-align: center;
    margin-bottom: 52px;
    animation: fadeDown 0.7s ease both;
  }

  .header-tag {
    display: inline-block;
    font-size: 11px;
    letter-spacing: 3px;
    text-transform: uppercase;
    color: var(--morandi-green);
    border: 1px solid var(--morandi-pale);
    padding: 5px 16px;
    border-radius: 20px;
    margin-bottom: 20px;
    background: rgba(168,192,176,0.1);
  }

  h1 {
    font-family: 'DM Serif Display', serif;
    font-size: 42px;
    color: var(--morandi-dark);
    line-height: 1.15;
    letter-spacing: -0.5px;
    margin-bottom: 12px;
  }

  h1 em {
    font-style: italic;
    color: var(--morandi-green);
  }

  .subtitle {
    font-size: 14px;
    color: var(--text-sub);
    letter-spacing: 0.5px;
    line-height: 1.7;
  }

  /* Method Tabs */
  .method-tabs {
    display: flex;
    gap: 8px;
    margin-bottom: 32px;
    background: var(--card-bg);
    border: 1px solid var(--border);
    border-radius: 14px;
    padding: 6px;
    animation: fadeUp 0.6s 0.1s ease both;
  }

  .tab-btn {
    flex: 1;
    padding: 11px 8px;
    border: none;
    background: transparent;
    border-radius: 10px;
    font-family: 'Noto Sans TC', sans-serif;
    font-size: 13px;
    color: var(--text-sub);
    cursor: pointer;
    transition: all 0.25s ease;
    letter-spacing: 0.3px;
  }

  .tab-btn.active {
    background: var(--morandi-green);
    color: white;
    font-weight: 500;
    box-shadow: 0 4px 16px rgba(125,155,138,0.35);
  }

  .tab-btn:not(.active):hover {
    background: var(--morandi-mist);
    color: var(--morandi-dark);
  }

  /* Cards */
  .card {
    background: var(--card-bg);
    border: 1px solid var(--border);
    border-radius: 20px;
    padding: 36px;
    margin-bottom: 20px;
    animation: fadeUp 0.6s 0.2s ease both;
    box-shadow: 0 2px 20px rgba(90,117,102,0.05);
  }

  .card-title {
    font-family: 'Noto Serif TC', serif;
    font-size: 14px;
    font-weight: 500;
    color: var(--morandi-deep);
    letter-spacing: 1px;
    margin-bottom: 28px;
    display: flex;
    align-items: center;
    gap: 10px;
  }

  .card-title::after {
    content: '';
    flex: 1;
    height: 1px;
    background: var(--border);
  }

  .card-icon {
    width: 28px; height: 28px;
    background: var(--morandi-mist);
    border-radius: 8px;
    display: flex; align-items: center; justify-content: center;
    font-size: 14px;
  }

  /* Gender Toggle */
  .gender-toggle {
    display: flex;
    gap: 12px;
    margin-bottom: 28px;
  }

  .gender-btn {
    flex: 1;
    padding: 14px;
    border: 2px solid var(--border);
    background: transparent;
    border-radius: 12px;
    cursor: pointer;
    font-family: 'Noto Sans TC', sans-serif;
    font-size: 14px;
    color: var(--text-sub);
    transition: all 0.2s;
    display: flex; align-items: center; justify-content: center; gap: 8px;
  }

  .gender-btn.active {
    border-color: var(--morandi-green);
    background: rgba(125,155,138,0.08);
    color: var(--morandi-dark);
    font-weight: 500;
  }

  /* Form Grid */
  .form-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 16px;
  }

  .form-grid.three { grid-template-columns: 1fr 1fr 1fr; }
  .form-grid.full { grid-template-columns: 1fr; }

  .form-group {
    display: flex;
    flex-direction: column;
    gap: 8px;
  }

  .form-group.span2 { grid-column: span 2; }

  label {
    font-size: 12px;
    color: var(--text-sub);
    letter-spacing: 0.8px;
    text-transform: uppercase;
    display: flex; align-items: center; gap: 6px;
  }

  label .hint {
    font-size: 11px;
    color: var(--text-light);
    text-transform: none;
    letter-spacing: 0;
  }

  .input-wrap {
    position: relative;
  }

  input[type="number"], select {
    width: 100%;
    padding: 13px 48px 13px 16px;
    border: 1.5px solid var(--border);
    border-radius: 12px;
    font-family: 'Noto Sans TC', sans-serif;
    font-size: 15px;
    color: var(--text-main);
    background: var(--bg);
    transition: border-color 0.2s, box-shadow 0.2s;
    -moz-appearance: textfield;
    outline: none;
  }

  input[type="number"]::-webkit-inner-spin-button,
  input[type="number"]::-webkit-outer-spin-button { -webkit-appearance: none; }

  input:focus, select:focus {
    border-color: var(--morandi-green);
    box-shadow: 0 0 0 3px rgba(125,155,138,0.15);
    background: white;
  }

  .unit {
    position: absolute;
    right: 14px; top: 50%;
    transform: translateY(-50%);
    font-size: 12px;
    color: var(--text-light);
    pointer-events: none;
    letter-spacing: 0.5px;
  }

  /* Method section show/hide */
  .method-section { display: none; }
  .method-section.active { display: block; }

  /* Calculate Button */
  .calc-btn {
    width: 100%;
    padding: 17px;
    background: var(--morandi-dark);
    color: white;
    border: none;
    border-radius: 14px;
    font-family: 'Noto Sans TC', sans-serif;
    font-size: 15px;
    letter-spacing: 1.5px;
    cursor: pointer;
    transition: all 0.25s;
    margin-top: 8px;
    position: relative;
    overflow: hidden;
  }

  .calc-btn::before {
    content: '';
    position: absolute;
    inset: 0;
    background: linear-gradient(135deg, rgba(255,255,255,0.07) 0%, transparent 60%);
  }

  .calc-btn:hover {
    background: var(--morandi-deep);
    transform: translateY(-1px);
    box-shadow: 0 8px 24px rgba(61,82,72,0.3);
  }

  .calc-btn:active { transform: translateY(0); }

  /* Result */
  #result {
    display: none;
    animation: fadeUp 0.5s ease both;
  }

  .result-hero {
    background: linear-gradient(135deg, var(--morandi-dark) 0%, var(--morandi-deep) 100%);
    border-radius: 20px;
    padding: 40px;
    color: white;
    text-align: center;
    margin-bottom: 20px;
    position: relative;
    overflow: hidden;
  }

  .result-hero::before {
    content: '';
    position: absolute;
    top: -60px; right: -60px;
    width: 200px; height: 200px;
    background: rgba(168,192,176,0.12);
    border-radius: 50%;
  }

  .result-hero::after {
    content: '';
    position: absolute;
    bottom: -40px; left: -40px;
    width: 140px; height: 140px;
    background: rgba(168,192,176,0.08);
    border-radius: 50%;
  }

  .result-label {
    font-size: 12px;
    letter-spacing: 3px;
    text-transform: uppercase;
    opacity: 0.7;
    margin-bottom: 12px;
    position: relative; z-index: 1;
  }

  .result-value {
    font-family: 'DM Serif Display', serif;
    font-size: 72px;
    line-height: 1;
    margin-bottom: 6px;
    position: relative; z-index: 1;
  }

  .result-unit {
    font-size: 24px;
    opacity: 0.8;
    vertical-align: super;
    font-family: 'Noto Serif TC', serif;
  }

  .result-category {
    display: inline-block;
    padding: 6px 20px;
    background: rgba(255,255,255,0.15);
    border-radius: 20px;
    font-size: 14px;
    letter-spacing: 1px;
    margin-top: 8px;
    position: relative; z-index: 1;
    backdrop-filter: blur(4px);
  }

  /* Range Bar */
  .range-bar-wrap {
    margin: 20px 0 8px;
    position: relative; z-index: 1;
  }

  .range-bar {
    height: 6px;
    border-radius: 3px;
    background: linear-gradient(to right, #7ecad0, #8db87e, #f0c060, #e07070);
    position: relative;
    margin-bottom: 6px;
  }

  .range-pointer {
    position: absolute;
    top: -5px;
    width: 16px; height: 16px;
    background: white;
    border-radius: 50%;
    transform: translateX(-50%);
    box-shadow: 0 2px 8px rgba(0,0,0,0.3);
    transition: left 0.6s cubic-bezier(0.34, 1.56, 0.64, 1);
  }

  .range-labels {
    display: flex;
    justify-content: space-between;
    font-size: 10px;
    opacity: 0.5;
    margin-top: 8px;
  }

  /* Detail Cards */
  .details-grid {
    display: grid;
    grid-template-columns: 1fr 1fr;
    gap: 14px;
    margin-bottom: 20px;
  }

  .detail-card {
    background: var(--card-bg);
    border: 1px solid var(--border);
    border-radius: 16px;
    padding: 22px;
  }

  .detail-card-label {
    font-size: 11px;
    color: var(--text-light);
    letter-spacing: 1px;
    text-transform: uppercase;
    margin-bottom: 8px;
  }

  .detail-card-value {
    font-family: 'DM Serif Display', serif;
    font-size: 28px;
    color: var(--morandi-dark);
    line-height: 1;
    margin-bottom: 4px;
  }

  .detail-card-unit {
    font-size: 13px;
    color: var(--text-sub);
  }

  .detail-card-desc {
    font-size: 12px;
    color: var(--text-light);
    margin-top: 6px;
    line-height: 1.5;
  }

  /* Standard Table */
  .standard-table {
    width: 100%;
    border-collapse: collapse;
  }

  .standard-table th {
    font-size: 11px;
    letter-spacing: 1px;
    text-transform: uppercase;
    color: var(--text-light);
    padding: 10px 12px;
    text-align: left;
    border-bottom: 1px solid var(--border);
    font-weight: 400;
  }

  .standard-table td {
    padding: 12px 12px;
    font-size: 13px;
    color: var(--text-sub);
    border-bottom: 1px solid rgba(212,227,220,0.4);
  }

  .standard-table tr:last-child td { border-bottom: none; }

  .standard-table tr.highlight-row td {
    color: var(--morandi-dark);
    font-weight: 500;
    background: rgba(125,155,138,0.06);
  }

  .dot {
    display: inline-block;
    width: 8px; height: 8px;
    border-radius: 50%;
    margin-right: 8px;
  }

  /* Tooltip */
  .tooltip-icon {
    display: inline-flex; align-items: center; justify-content: center;
    width: 15px; height: 15px;
    border: 1px solid var(--morandi-sage);
    border-radius: 50%;
    font-size: 9px;
    color: var(--text-light);
    cursor: help;
    position: relative;
  }

  .tooltip-icon:hover::after {
    content: attr(data-tip);
    position: absolute;
    bottom: calc(100% + 6px);
    left: 50%;
    transform: translateX(-50%);
    background: var(--morandi-dark);
    color: white;
    font-size: 11px;
    padding: 6px 10px;
    border-radius: 8px;
    white-space: nowrap;
    z-index: 10;
    letter-spacing: 0;
    text-transform: none;
    pointer-events: none;
    line-height: 1.5;
    max-width: 200px;
    white-space: normal;
    text-align: center;
  }

  /* Info note */
  .info-note {
    background: rgba(168,192,176,0.12);
    border-left: 3px solid var(--morandi-sage);
    border-radius: 0 10px 10px 0;
    padding: 12px 16px;
    font-size: 12px;
    color: var(--text-sub);
    line-height: 1.7;
    margin-top: 16px;
  }

  /* Animations */
  @keyframes fadeDown {
    from { opacity: 0; transform: translateY(-20px); }
    to { opacity: 1; transform: translateY(0); }
  }

  @keyframes fadeUp {
    from { opacity: 0; transform: translateY(16px); }
    to { opacity: 1; transform: translateY(0); }
  }

  /* Responsive */
  @media (max-width: 600px) {
    .form-grid { grid-template-columns: 1fr; }
    .form-grid.three { grid-template-columns: 1fr 1fr; }
    .form-group.span2 { grid-column: span 1; }
    .details-grid { grid-template-columns: 1fr; }
    h1 { font-size: 32px; }
    .result-value { font-size: 56px; }
    .card { padding: 24px; }
    .result-hero { padding: 30px 24px; }
  }
</style>
</head>
<body>

<div class="container">

  <header>
    <div class="header-tag">Body Composition</div>
    <h1>é«”è„‚ <em>åˆ†æå„€</em></h1>
    <p class="subtitle">å¤šç¨®å…¬å¼è¨ˆç®—ï¼Œå…¨é¢äº†è§£ä½ çš„èº«é«”çµ„æˆç‹€æ³</p>
  </header>

  <!-- Method Tabs -->
  <div class="method-tabs">
    <button class="tab-btn active" onclick="switchMethod('bmi')">BMI ä¼°ç®—æ³•</button>
    <button class="tab-btn" onclick="switchMethod('navy')">æµ·è»æ³•</button>
    <button class="tab-btn" onclick="switchMethod('skinfold')">çš®è„‚åšåº¦æ³•</button>
    <button class="tab-btn" onclick="switchMethod('heritage')">HERITAGEæ³•</button>
  </div>

  <!-- Input Card -->
  <div class="card">

    <!-- Gender -->
    <div class="card-title"><span class="card-icon">ğŸ‘¤</span>åŸºæœ¬è³‡æ–™</div>
    <div class="gender-toggle">
      <button class="gender-btn active" id="btn-male" onclick="setGender('male')">â™‚ ç”·æ€§</button>
      <button class="gender-btn" id="btn-female" onclick="setGender('female')">â™€ å¥³æ€§</button>
    </div>

    <div class="diagram-card" id="body-diagram">
      <svg class="human-svg" viewBox="0 0 100 200">
        <path class="body-outline" d="M50,20 C55,20 60,25 60,35 C60,45 58,48 65,55 C75,65 75,90 75,120 L70,180 L55,180 L50,140 L45,180 L30,180 L25,120 C25,90 25,65 35,55 C42,48 40,45 40,35 C40,25 45,20 50,20" />
    
        <circle id="pt-neck" class="measure-point" cx="50" cy="42" r="4" />
        <circle id="pt-waist" class="measure-point" cx="50" cy="85" r="4" />
        <circle id="pt-hip" class="measure-point" cx="50" cy="105" r="4" />
        <circle id="pt-chest" class="measure-point" cx="35" cy="65" r="4" />
        <circle id="pt-thigh" class="measure-point" cx="40" cy="140" r="4" />
      </svg>
    </div>  

    <div class="form-grid" style="margin-bottom:20px">
      <div class="form-group">
        <label>å¹´é½¡</label>
        <div class="input-wrap">
          <input type="number" id="age" placeholder="25" min="5" max="100">
          <span class="unit">æ­²</span>
        </div>
      </div>
      <div class="form-group">
        <label>é«”é‡</label>
        <div class="input-wrap">
          <input type="number" id="weight" placeholder="65" min="20" max="300" step="0.1">
          <span class="unit">kg</span>
        </div>
      </div>
      <div class="form-group">
        <label>èº«é«˜</label>
        <div class="input-wrap">
          <input type="number" id="height" placeholder="170" min="100" max="250">
          <span class="unit">cm</span>
        </div>
      </div>
    </div>

    <!-- BMI Method (default, no extra inputs) -->
    <div id="method-bmi" class="method-section active">
      <div class="info-note">
        ğŸ“ <strong>BMI ä¼°ç®—æ³•</strong>ï¼ˆDeurenberg å…¬å¼ï¼‰<br>
        ä½¿ç”¨èº«é«”è³ªé‡æŒ‡æ•¸ï¼ˆBMIï¼‰æ­é…å¹´é½¡ã€æ€§åˆ¥æ¨ç®—é«”è„‚ç‡ï¼Œé©åˆä¸€èˆ¬å¿«é€Ÿä¼°ç®—ã€‚<br>
        å…¬å¼ï¼šé«”è„‚% = (1.2 Ã— BMI) + (0.23 Ã— å¹´é½¡) âˆ’ (10.8 Ã— æ€§åˆ¥) âˆ’ 5.4
      </div>
    </div>

    <!-- Navy Method -->
    <div id="method-navy" class="method-section">
      <div class="card-title" style="margin-top:8px"><span class="card-icon">ğŸ“</span>åœåº¦æ¸¬é‡</div>
      <div id="navy-inputs" class="form-grid three">
        <!-- filled by JS -->
      </div>
      <div class="info-note">
        ğŸ”µ <strong>ç¾åœ‹æµ·è»æ³•</strong><br>
        ç”±ç¾åœ‹æµ·è»ç ”ç©¶æ‰€é–‹ç™¼ï¼Œä»¥é ¸åœã€è…¹åœï¼ˆç”·ï¼‰æˆ–è…°åœã€è‡€åœï¼ˆå¥³ï¼‰è¨ˆç®—é«”è„‚ï¼Œæº–ç¢ºåº¦è¼ƒé«˜ã€‚
      </div>
    </div>

    <!-- Skinfold Method -->
    <div id="method-skinfold" class="method-section">
      <div class="card-title" style="margin-top:8px"><span class="card-icon">ğŸ”¬</span>çš®è„‚å¤¾æ¸¬é‡å€¼</div>
      <div id="skinfold-inputs" class="form-grid three">
        <!-- filled by JS -->
      </div>
      <div class="info-note">
        ğŸ“Œ <strong>ä¸‰é»çš®è„‚åšåº¦æ³•</strong>ï¼ˆJackson &amp; Pollockï¼‰<br>
        ä½¿ç”¨çš®è„‚å¤¾æ¸¬é‡ç‰¹å®šéƒ¨ä½çš„çš®ä¸‹è„‚è‚ªåšåº¦ï¼Œç²¾ç¢ºåº¦é«˜ï¼Œéœ€è¦å°ˆæ¥­å·¥å…·è¼”åŠ©ã€‚
      </div>
    </div>

    <!-- HERITAGE Method -->
    <div id="method-heritage" class="method-section">
      <div class="form-grid" style="margin-bottom:16px">
        <div class="form-group">
          <label>è…°åœ</label>
          <div class="input-wrap">
            <input type="number" id="heritage-waist" placeholder="80" min="40" max="200" step="0.5">
            <span class="unit">cm</span>
          </div>
        </div>
        <div class="form-group">
          <label>è‡€åœ</label>
          <div class="input-wrap">
            <input type="number" id="heritage-hip" placeholder="95" min="40" max="200" step="0.5">
            <span class="unit">cm</span>
          </div>
        </div>
      </div>
      <div class="info-note">
        ğŸ§¬ <strong>HERITAGE å®¶æ—ç ”ç©¶æ³•</strong><br>
        çµåˆè…°è‡€åœæ¯”ã€èº«é«˜é«”é‡èˆ‡å¹´é½¡çš„è¤‡åˆå…¬å¼ï¼Œå°é æ¸¬å…§è‡Ÿè„‚è‚ªæœ‰è¼ƒå¥½çš„ç›¸é—œæ€§ã€‚
      </div>
    </div>

    <button class="calc-btn" onclick="calculate()">è¨ˆã€€ç®—ã€€é«”ã€€è„‚ã€€ç‡</button>
  </div>

  <!-- Result -->
  <div id="result">

    <div class="result-hero">
      <div class="result-label">ä¼°ç®—é«”è„‚ç‡</div>
      <div class="result-value"><span id="fat-pct">â€”</span><span class="result-unit">%</span></div>
      <div class="result-category" id="fat-category">â€”</div>
      <div class="range-bar-wrap">
        <div class="range-bar">
          <div class="range-pointer" id="range-pointer" style="left: 0%"></div>
        </div>
        <div class="range-labels">
          <span>åä½</span><span>ç†æƒ³</span><span>åé«˜</span><span>è‚¥èƒ–</span>
        </div>
      </div>
    </div>

    <div class="details-grid">
      <div class="detail-card">
        <div class="detail-card-label">BMI æŒ‡æ•¸</div>
        <div class="detail-card-value" id="res-bmi">â€”</div>
        <div class="detail-card-unit">kg/mÂ²</div>
        <div class="detail-card-desc" id="res-bmi-cat">â€”</div>
      </div>
      <div class="detail-card">
        <div class="detail-card-label">è„‚è‚ªé‡é‡</div>
        <div class="detail-card-value" id="res-fat-kg">â€”</div>
        <div class="detail-card-unit">kg</div>
        <div class="detail-card-desc">èº«é«”ç¸½è„‚è‚ªè³ªé‡</div>
      </div>
      <div class="detail-card">
        <div class="detail-card-label">å»è„‚é«”é‡ï¼ˆLBMï¼‰</div>
        <div class="detail-card-value" id="res-lbm">â€”</div>
        <div class="detail-card-unit">kg</div>
        <div class="detail-card-desc">è‚Œè‚‰ã€éª¨éª¼ã€æ°´åˆ†ç¸½å’Œ</div>
      </div>
      <div class="detail-card">
        <div class="detail-card-label">ç†æƒ³é«”é‡ç¯„åœ</div>
        <div class="detail-card-value" id="res-ideal">â€”</div>
        <div class="detail-card-unit">kg</div>
        <div class="detail-card-desc" id="res-ideal-desc">ç†æƒ³é«”è„‚ç‡å°æ‡‰çš„ç¯„åœ</div>
      </div>
    </div>

    <!-- TDEE & Fitness Tips -->
    <div class="card" style="animation-delay:0.1s">
      <div class="card-title"><span class="card-icon">ğŸ”¥</span>ç†±é‡éœ€æ±‚ä¼°ç®—</div>
      <div class="details-grid" style="margin-bottom:0">
        <div class="detail-card" style="border:none; padding:0">
          <div class="detail-card-label">åŸºç¤ä»£è¬ç‡ï¼ˆBMRï¼‰</div>
          <div class="detail-card-value" id="res-bmr">â€”</div>
          <div class="detail-card-unit">kcal/æ—¥</div>
          <div class="detail-card-desc">éœæ­¢ç‹€æ…‹ä¸‹çš„æœ€ä½èƒ½é‡æ¶ˆè€—ï¼ˆKatch-McArdleï¼‰</div>
        </div>
        <div class="detail-card" style="border:none; padding:0">
          <div class="detail-card-label">æ¯æ—¥å»ºè­°æ”å–ï¼ˆTDEEï¼‰</div>
          <div class="detail-card-value" id="res-tdee">â€”</div>
          <div class="detail-card-unit">kcal/æ—¥</div>
          <div class="detail-card-desc" id="res-tdee-desc">ä»¥è¼•åº¦æ´»å‹•é‡ä¼°ç®—</div>
        </div>
      </div>
    </div>

    <!-- Standards Table -->
    <div class="card" style="animation-delay:0.15s">
      <div class="card-title"><span class="card-icon">ğŸ“Š</span>é«”è„‚ç‡åƒè€ƒæ¨™æº–</div>
      <table class="standard-table" id="standard-table"></table>
      <div class="info-note">
        âš ï¸ é«”è„‚ç‡æ•¸å€¼ç‚ºä¼°ç®—çµæœï¼Œå—æ¸¬é‡æ–¹å¼ã€å€‹é«”å·®ç•°å½±éŸ¿ã€‚å¦‚éœ€ç²¾ç¢ºæ•¸å€¼å»ºè­°ä½¿ç”¨ DEXA æƒææˆ–æ°´ä¸‹ç¨±é‡ã€‚æœ¬å·¥å…·åƒ…ä¾›åƒè€ƒï¼Œä¸æ§‹æˆé†«ç™‚å»ºè­°ã€‚
      </div>
    </div>

  </div>
</div>

<script>
let gender = 'male';
let method = 'bmi';

function setGender(g) {
  gender = g;
  document.getElementById('btn-male').classList.toggle('active', g === 'male');
  document.getElementById('btn-female').classList.toggle('active', g === 'female');
  renderNavyInputs();
  renderSkinfoldInputs();
}

function switchMethod(m) {
  method = m;
  document.querySelectorAll('.tab-btn').forEach((btn, i) => {
    btn.classList.toggle('active', ['bmi','navy','skinfold','heritage'][i] === m);
  });
  document.querySelectorAll('.method-section').forEach(s => s.classList.remove('active'));
  document.getElementById('method-' + m).classList.add('active');

  // --- æ›´æ–°ç¤ºæ„åœ–é‚è¼¯ ---
  // å…ˆæ¸…é™¤æ‰€æœ‰é«˜äº®
  document.querySelectorAll('.measure-point').forEach(pt => pt.classList.remove('active'));

  if (m === 'navy') {
    document.getElementById('pt-neck').classList.add('active');
    document.getElementById('pt-waist').classList.add('active');
    if (gender === 'female') document.getElementById('pt-hip').classList.add('active');
  } else if (m === 'skinfold') {
    document.getElementById('pt-chest').classList.add('active');
    document.getElementById('pt-waist').classList.add('active');
    document.getElementById('pt-thigh').classList.add('active');
  } else if (m === 'heritage') {
    document.getElementById('pt-waist').classList.add('active');
    document.getElementById('pt-hip').classList.add('active');
  }
}

function renderNavyInputs() {
  const el = document.getElementById('navy-inputs');
  if (gender === 'male') {
    el.innerHTML = `
      <div class="form-group">
        <label>é ¸åœ</label>
        <div class="input-wrap"><input type="number" id="neck" placeholder="37" min="20" max="80" step="0.5"><span class="unit">cm</span></div>
      </div>
      <div class="form-group">
        <label>è…¹åœ</label>
        <div class="input-wrap"><input type="number" id="abdomen" placeholder="85" min="40" max="200" step="0.5"><span class="unit">cm</span></div>
      </div>`;
  } else {
    el.innerHTML = `
      <div class="form-group">
        <label>é ¸åœ</label>
        <div class="input-wrap"><input type="number" id="neck" placeholder="33" min="20" max="80" step="0.5"><span class="unit">cm</span></div>
      </div>
      <div class="form-group">
        <label>è…°åœ</label>
        <div class="input-wrap"><input type="number" id="waist" placeholder="70" min="40" max="200" step="0.5"><span class="unit">cm</span></div>
      </div>
      <div class="form-group">
        <label>è‡€åœ</label>
        <div class="input-wrap"><input type="number" id="hip" placeholder="95" min="40" max="200" step="0.5"><span class="unit">cm</span></div>
      </div>`;
  }
}

function renderSkinfoldInputs() {
  const el = document.getElementById('skinfold-inputs');
  if (gender === 'male') {
    el.innerHTML = `
      <div class="form-group">
        <label>èƒ¸éƒ¨çš®è„‚</label>
        <div class="input-wrap"><input type="number" id="sf1" placeholder="10" min="1" max="80" step="0.5"><span class="unit">mm</span></div>
      </div>
      <div class="form-group">
        <label>è…¹éƒ¨çš®è„‚</label>
        <div class="input-wrap"><input type="number" id="sf2" placeholder="20" min="1" max="80" step="0.5"><span class="unit">mm</span></div>
      </div>
      <div class="form-group">
        <label>å¤§è…¿çš®è„‚</label>
        <div class="input-wrap"><input type="number" id="sf3" placeholder="15" min="1" max="80" step="0.5"><span class="unit">mm</span></div>
      </div>`;
  } else {
    el.innerHTML = `
      <div class="form-group">
        <label>ä¸‰é ­è‚Œçš®è„‚</label>
        <div class="input-wrap"><input type="number" id="sf1" placeholder="15" min="1" max="80" step="0.5"><span class="unit">mm</span></div>
      </div>
      <div class="form-group">
        <label>é«‚éª¨çš®è„‚</label>
        <div class="input-wrap"><input type="number" id="sf2" placeholder="18" min="1" max="80" step="0.5"><span class="unit">mm</span></div>
      </div>
      <div class="form-group">
        <label>å¤§è…¿çš®è„‚</label>
        <div class="input-wrap"><input type="number" id="sf3" placeholder="20" min="1" max="80" step="0.5"><span class="unit">mm</span></div>
      </div>`;
  }
}

// Init
renderNavyInputs();
renderSkinfoldInputs();

function getVal(id) {
  const el = document.getElementById(id);
  return el ? parseFloat(el.value) : NaN;
}

function calculate() {
  const age = getVal('age');
  const weight = getVal('weight');
  const height = getVal('height');

  if (!age || !weight || !height || age < 5 || weight < 20 || height < 100) {
    alert('è«‹ç¢ºèªå¹´é½¡ã€é«”é‡ã€èº«é«˜å‡å·²å¡«å¯«ä¸”æ•¸å€¼åˆç†');
    return;
  }

  const bmi = weight / ((height / 100) ** 2);
  let fatPct = null;
  let methodUsed = '';

  if (method === 'bmi') {
    // Deurenberg formula
    const sexFactor = gender === 'male' ? 1 : 0;
    fatPct = (1.2 * bmi) + (0.23 * age) - (10.8 * sexFactor) - 5.4;
    methodUsed = 'Deurenberg / BMI ä¼°ç®—æ³•';
  }
  else if (method === 'navy') {
    const neck = getVal('neck');
    if (gender === 'male') {
      const abdomen = getVal('abdomen');
      if (!neck || !abdomen) { alert('è«‹å¡«å¯«é ¸åœèˆ‡è…¹åœ'); return; }
      fatPct = 86.010 * Math.log10(abdomen - neck) - 70.041 * Math.log10(height) + 36.76;
    } else {
      const waist = getVal('waist');
      const hip = getVal('hip');
      if (!neck || !waist || !hip) { alert('è«‹å¡«å¯«é ¸åœã€è…°åœèˆ‡è‡€åœ'); return; }
      fatPct = 163.205 * Math.log10(waist + hip - neck) - 97.684 * Math.log10(height) - 78.387;
    }
    methodUsed = 'ç¾åœ‹æµ·è»æ³•ï¼ˆU.S. Navy Methodï¼‰';
  }
  else if (method === 'skinfold') {
    const sf1 = getVal('sf1'), sf2 = getVal('sf2'), sf3 = getVal('sf3');
    if (!sf1 || !sf2 || !sf3) { alert('è«‹å¡«å¯«ä¸‰å€‹çš®è„‚åšåº¦æ•¸å€¼'); return; }
    const sum = sf1 + sf2 + sf3;
    let bodyDensity;
    if (gender === 'male') {
      bodyDensity = 1.10938 - (0.0008267 * sum) + (0.0000016 * sum * sum) - (0.0002574 * age);
    } else {
      bodyDensity = 1.0994921 - (0.0009929 * sum) + (0.0000023 * sum * sum) - (0.0001392 * age);
    }
    fatPct = (4.95 / bodyDensity - 4.5) * 100; // Siri equation
    methodUsed = 'Jackson & Pollock ä¸‰é»çš®è„‚æ³• + Siri æ–¹ç¨‹å¼';
  }
  else if (method === 'heritage') {
    const waist = getVal('heritage-waist');
    const hip = getVal('heritage-hip');
    if (!waist || !hip) { alert('è«‹å¡«å¯«è…°åœèˆ‡è‡€åœ'); return; }
    const whr = waist / hip;
    if (gender === 'male') {
      fatPct = (0.567 * waist) + (0.101 * age) - (31.992);
      // adjust with whr
      fatPct = fatPct > 0 ? fatPct : (whr * 100 - 60 + age * 0.1);
    } else {
      fatPct = (0.439 * waist) + (0.221 * age) - (9.4);
    }
    methodUsed = 'HERITAGE å®¶æ—ç ”ç©¶æ³•';
  }

  fatPct = Math.max(1, Math.min(60, fatPct));

  // BMR (Katch-McArdle uses LBM)
  const fatKg = weight * (fatPct / 100);
  const lbm = weight - fatKg;
  const bmr = 370 + (21.6 * lbm);
  const tdee = bmr * 1.375; // light activity

  // BMI category
  let bmiCat = '';
  if (bmi < 18.5) bmiCat = 'éè¼•';
  else if (bmi < 24) bmiCat = 'æ­£å¸¸';
  else if (bmi < 27) bmiCat = 'éé‡';
  else if (bmi < 30) bmiCat = 'è¼•åº¦è‚¥èƒ–';
  else bmiCat = 'ä¸­é‡åº¦è‚¥èƒ–';

  // Fat category
  const standards = gender === 'male'
    ? { low: 6, fit: 14, acceptable: 18, obese: 25 }
    : { low: 14, fit: 21, acceptable: 25, obese: 32 };

  let fatCat = '', catColor = '';
  if (fatPct < standards.low) { fatCat = 'é«”è„‚éä½'; catColor = '#7ecad0'; }
  else if (fatPct < standards.fit) { fatCat = 'é‹å‹•å“¡é«”æ…‹'; catColor = '#8db87e'; }
  else if (fatPct < standards.acceptable) { fatCat = 'å¥åº·ç†æƒ³ç¯„åœ'; catColor = '#8db87e'; }
  else if (fatPct < standards.obese) { fatCat = 'é«”è„‚åé«˜'; catColor = '#f0c060'; }
  else { fatCat = 'è‚¥èƒ–ç¯„åœ'; catColor = '#e07070'; }

  // Ideal weight: target fat 15% men, 22% women
  const targetFat = gender === 'male' ? 15 : 22;
  const idealWeightMin = lbm / (1 - (targetFat - 2) / 100);
  const idealWeightMax = lbm / (1 - (targetFat + 2) / 100);

  // Range pointer position (0%-60% range)
  const ptrPct = Math.max(2, Math.min(98, (fatPct / 55) * 100));

  // Update UI
  document.getElementById('fat-pct').textContent = fatPct.toFixed(1);
  document.getElementById('fat-category').textContent = fatCat;
  document.getElementById('res-bmi').textContent = bmi.toFixed(1);
  document.getElementById('res-bmi-cat').textContent = bmiCat;
  document.getElementById('res-fat-kg').textContent = fatKg.toFixed(1);
  document.getElementById('res-lbm').textContent = lbm.toFixed(1);
  document.getElementById('res-ideal').textContent = idealWeightMin.toFixed(0) + 'ï½' + idealWeightMax.toFixed(0);
  document.getElementById('res-ideal-desc').textContent = `ç›®æ¨™é«”è„‚ ${targetFat}% Â± 2%`;
  document.getElementById('res-bmr').textContent = Math.round(bmr);
  document.getElementById('res-tdee').textContent = Math.round(tdee);
  document.getElementById('res-tdee-desc').textContent = `ä»¥è¼•åº¦æ´»å‹•é‡ä¼°ç®—ï¼ˆè¼•é‹å‹• 1-3 æ¬¡/é€±ï¼‰`;

  setTimeout(() => {
    document.getElementById('range-pointer').style.left = ptrPct + '%';
  }, 100);

  // Standard table
  const rows = gender === 'male' ? [
    ['éä½', '< 6%', '#7ecad0', fatPct < 6],
    ['é‹å‹•å“¡', '6 â€“ 13%', '#8db87e', fatPct >= 6 && fatPct < 14],
    ['å¥åº·ç†æƒ³', '14 â€“ 17%', '#6bab72', fatPct >= 14 && fatPct < 18],
    ['å¯æ¥å—', '18 â€“ 24%', '#f0c060', fatPct >= 18 && fatPct < 25],
    ['è‚¥èƒ–', 'â‰¥ 25%', '#e07070', fatPct >= 25],
  ] : [
    ['éä½', '< 14%', '#7ecad0', fatPct < 14],
    ['é‹å‹•å“¡', '14 â€“ 20%', '#8db87e', fatPct >= 14 && fatPct < 21],
    ['å¥åº·ç†æƒ³', '21 â€“ 24%', '#6bab72', fatPct >= 21 && fatPct < 25],
    ['å¯æ¥å—', '25 â€“ 31%', '#f0c060', fatPct >= 25 && fatPct < 32],
    ['è‚¥èƒ–', 'â‰¥ 32%', '#e07070', fatPct >= 32],
  ];

  const table = document.getElementById('standard-table');
  table.innerHTML = `<tr><th>ç­‰ç´š</th><th>${gender === 'male' ? 'ç”·æ€§' : 'å¥³æ€§'}æ¨™æº–</th><th>ç‹€æ…‹</th></tr>` +
    rows.map(([name, range, color, isMe]) => `
      <tr class="${isMe ? 'highlight-row' : ''}">
        <td><span class="dot" style="background:${color}"></span>${name}</td>
        <td>${range}</td>
        <td>${isMe ? 'â† æ‚¨ç›®å‰çš„ä½ç½®' : ''}</td>
      </tr>
    `).join('');

  const resultEl = document.getElementById('result');
  resultEl.style.display = 'block';
  setTimeout(() => resultEl.scrollIntoView({ behavior: 'smooth', block: 'start' }), 50);
}
</script>
</body>
</html>